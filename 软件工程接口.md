### 数据接口

#### 初始化

（不需要token参数）

|分发接口|数据|接口功能|方向|
|:----|:----|:----|:----|:----|:----|
|/client/init|roomId : int<br>initTmp : int|初始化房间号<br>房间温度|客户端->服务器|
|/server/comfirmInit|ack : boolean|（websocket实现）|    |


### 超级用户

创建账户

存储：用户名、密码、角色（管理员与经理两种）

#### 管理员登录界面

登录使用md5加密

功能：

1. 未通过管理员登录验证，页面重定	向至login?error
2. 管理员logout之后重定向到本页面
3. ~~token 超时之后重定向到本界面~~
|接口名称|接口方法|参数|接口功能|
|:----|:----|:----|:----|
|/manager/login|post|adminId,password（md5）|管理员登录|
|/manager/logout|post|adminId|管理员注销|
|    |    |    |    |
|    |    |    |    |

#### 管理员界面

功能：

1. 打开/关闭全部空调
2. 提供roomId，打开/关闭某一房间的空调，服务器返回true or false
3. 监控各房间情况
4. 修改计费策略
5. 发送消息（全体/某个）
6. 生成全部/某个报表详单
|接口名称|接口方法|参数|接口功能|
|:----|:----|:----|:----|:----|
|/manager/openRoom|    |**defaultTmp**<br>**roomId**|开房|
|/manager/seeRoomInfo|    |roomId|发送房号（或ALL），查询房间具体信息（或所有房间具体信息）|
|/manager/getRoomList|    |    |查询房间信息（roomId ）|
|/manager/controlRoom|    |roomId<br>tmp,<br>wind,<br>power<br>|roomId = num / all<br>tmp : val = 16~30<br>wind : val = 0/1/2/3<br>power: val = 0/1<br>-1代表不进行更改|
|/admin/simpleCost|    |roomId|roomId = num / all|
|/admin/detailCost|    |roomId|roomId = num / all|
|/admin/sendMsg|    |msg，roomId|roomId = num / all，消息|
|/manager/detailCost|    |list[{time,roomId,currentTmp,targetTmp,fee}]|    |
|/manager/detailCostFile|    |    |下载文件|
|    |    |    |    |

#### 客户端界面

功能：

1. 空调启动与关闭
2. 温度设置请求和风速设置
3. 更新显示模块
4. 故障报告
5. 使用说明
6. 联系客服
|分发接口|数据|接口功能|
|:----|:----|:----|
|/client/open|token,power|打开该房间的空调,power:1/0|
|/client/set|token,temp,speed|温度设置请求和风速设置<br>tmp : val = 16~30<br>wind : val = 0/1/2/3<br>-1代表不进行更改|
|/client/updateStatus|nowTmp<br>token|传输环境温度<br>更新从控机的显示模块|
|/client/error|token,errorMsg|发送故障报告|
|/client/help|无|查看帮助|
|/client/contact|token,msg|联系客服<br><br>|



服务器功能

|/server/retRole|    |result: boolean<br>role:（管理员与经理两种）|服务器端传回确认登录<br>登录成功/失败|
|:----|:----|:----|:----|
|    |    |    |    |
|/server/retRoomList|    |roomList[{id, idle}]|服务器端向管理员端返回所有房间号和在线状态|
|/server/comfirm|    |返回确认信息|    |
|/server/retSimpleCost|    |beginTime,  endTime, cost|返回入住时间、退房时间与总开销|
|/server/error|    |msg|错误信息|
|/server/retFeeList|    |beginTime,  endTime, totalcost<br>list[{time,roomId,currentTmp,targetTmp,fee}]|返回入住时间、退房时间与总开销<br>列表：[时间(min)，房间号，当前温度，目标温度，费用]|



|    |    |    |    |
|:----|:----|:----|:----|:----|
|/server/openRoom|    |**defaultTmp**<br>**token**|服务器向房间发送开房信息|
|/server/roomInfo|    |**roomInfoList [{}]**|房间号roomId、设定温度setTmp、环境温度nowTmp、风速wind、|
|/server/openAll|post|无|打开全部空调|
|/server/closeAll|post|无|关闭全部空调|
|/server/open|post|roomId|打开某个房间的空调|
|/server/close|post|roomId|关闭某个房间的空调|
|/server/updateUser|post|无|更新所有房间信息（ajax轮询）|
|/server/updatePrice|post|perprice...|调整空调计费策略|
|/server/bulletin|post|data|公告|
|/server/sendMSG|post|roomId,data|单独发送消息|
|/server/generateRPT|post|roomId|userId=0时生成全部表单|




